<p align="center">
    <h1 align="center">Демо Rest API сервис для построения оптимального расписания сотрудников</h1>
    <br>
</p>

Rest API с применением PHP фреймворка `Yii2`, `Mysql` в Docker-окружении.
Представляет из себя две сущности: Пользователи `users`, собрания `meetings`, а также связи между ними `meetings_users_links`. CRUD-эндпоинты на каждую и отдельный роут на составление оптимального расписания.

### Запуск

Копируем демо-конфигурационный файл с переменными окружения:
```
cp .env-dist .env
```

Для первого запуска, установке всех зависимостей и инициализации миграций необходимо использовать bash-скрипт:

```
sh clean-start.sh
```

В дальнейшем командой:

```
docker-compose up -d --build
```


## Основные роуты сервиса пользователей

POST,PUT /users - Создание/обновление пользователей:
- name - Имя пользователя

POST /users/{id}/attach - Назначить пользователя на собрания, заданные в форме:
- meetings_ids - Список идентификаторов собраний через запятую

PUT /users/{id}/detach - Снять пользователя с собраний, заданных в форме:
- meetings_ids - Список идентификаторов собраний через запятую

GET /users - Фильтрация пользователей по query-параметрам:
- name - Поиск по имени пользователя
- per-page=3; page=1 - Пагинация
- order_by=id ASC - Параметры сортировки

GET /users/{id} - Получить данные пользователя по идентификатору

GET /users/{id}/schedule - Получить оптимальное расписание для пользователя на указанную дату по query-параметрам:
- date_in=2023-09-17 09:00 - Дата от
- date_end=2023-09-17 18:00 - Дата до

## Основные роуты сервиса собраний

POST,PUT /meetings - Создание/обновление собраний:
- title - Название/тема собрания (опционально)
- date_in=2023-09-17 09:00 - Дата начала собрания
- date_end=2023-09-17 18:00 - Дата конца собрания
- state=ACTIVE/CANCELED/FINISHED - Статус собрания (По-умолчанию - ACTIVE)

POST /meetings/{id}/attach - Назначить на собрание пользователей, заданных в форме:
- users_ids - Список идентификаторов пользователей через запятую

PUT /meetings/{id}/detach - Снять с собрания пользователей, заданных в форме:
- users_ids - Список идентификаторов пользователей через запятую

GET /meetings - Фильтрация собраний по query-параметрам:
- title - Поиск по названию
- state - Поиск по статусу собраний (По-умолчанию - ACTIVE)
- date_in=2023-09-17 09:00 - Дата начала собрания (>=)
- date_end=2023-09-17 18:00 - Дата конца собрания (<=)
- per-page=3; page=1 - Пагинация
- order_by=id ASC - Параметры сортировки

GET /meetings/{id} - Получить данные собрания по идентификатору